<!DOCTYPE html>
<html>
<head>
  <title>Stellar Webhooks</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:300,300italic,700,700italic">
  <link rel="stylesheet" href="//cdn.rawgit.com/necolas/normalize.css/master/normalize.css">
  <link rel="stylesheet" href="//cdn.rawgit.com/milligram/milligram/master/dist/milligram.min.css">
</head>

<body>
  <div class="container">
    <h2>Enter Your Webhook</h2>
    <form id="webhook_form">
      <fieldset>
        <label for="address_id">Stellar Address</label>
        <input type="text" placeholder="Address" id="address_id">

        <label for="webhook_type">Age Range</label>
        <select id="webhook_type">
          <option value="account_created">Account Created</option>
          <option value="account_removed">Account Removed</option>
          <option value="account_credited">Account Credited</option>
          <option value="account_debited">Account Debited</option>
        </select>

        <label for="webhook_url">URL</label>
        <input type="text" placeholder="http://webhook.example.com" id="webhook_url">
        <input class="button-primary" type="submit" value="Send">
      </fieldset>
    </form>
  </div>
  <script>
    var form = document.getElementById("webhook_form");
    form.addEventListener("submit", function (event) {
      event.preventDefault();
      processSubmit();
    });

    function processSubmit() {
      var xmlhttp = new XMLHttpRequest();
      //Manually do this................
      var a = form.elements['address_id'].value;
      var b = form.elements['webhook_type'].value;
      var c = form.elements['webhook_url'].value;

      xmlhttp.onreadystatechange = function() {
          if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
            //alert(xmlhttp.responseText); // Here is the response
          } else if (xmlhttp.readyState == 4) {
            alert(xmlhttp.responseText + "error");
          }
      }

      xmlhttp.open("POST","/register",true);
      xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
      xmlhttp.send("address_id="+encodeURIComponent(a)+"&webhook_type="+
                    encodeURIComponent(b)+"&webhook_url="+encodeURIComponent(c));

      return false;
    }
  </script>
</body>

</html>
